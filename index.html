<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì–´ë¨¸ë‹ˆë¥¼ ìœ„í•œ ì§€í•˜ì²  ë„ìš°ë¯¸</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700;800&display=swap');
        
        body {
            font-family: 'Nanum+Gothic', sans-serif;
            background-color: #f0f4f8;
            -webkit-tap-highlight-color: transparent;
        }
        
        .big-button {
            transition: transform 0.1s active;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        
        .big-button:active {
            transform: scale(0.98);
        }

        /* í˜¸ì„ ë³„ ìƒ‰ìƒ ì •ì˜ */
        .line-1 { background-color: #0052A4; }
        .line-2 { background-color: #009D3E; }
        .line-3 { background-color: #EF7C1C; }
        .line-4 { background-color: #00A5DE; }
        .line-5 { background-color: #996CAC; }
        .line-6 { background-color: #CD7C2F; }
        .line-7 { background-color: #747F00; }
        .line-8 { background-color: #E6186C; }
        .line-9 { background-color: #BDB092; }
        .line-gj { background-color: #77C4A3; } /* ê²½ì˜ì¤‘ì•™ */
        .line-suin { background-color: #F5A200; } /* ìˆ˜ì¸ë¶„ë‹¹ */
        .line-shin { background-color: #D4003B; } /* ì‹ ë¶„ë‹¹ */
        .line-gyeongchun { background-color: #0C8E72; } /* ê²½ì¶˜ */

        .station-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            color: white;
            font-weight: bold;
            font-size: 1rem;
        }

        /* ê²€ìƒ‰ ìë™ì™„ì„± ëª©ë¡ ìŠ¤íƒ€ì¼ */
        #search-results {
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body class="max-w-md mx-auto min-h-screen bg-gray-50 pb-10">

    <!-- í—¤ë” -->
    <header class="bg-blue-600 text-white p-6 text-center shadow-lg sticky top-0 z-50">
        <h1 class="text-3xl font-black mb-1">ì§€í•˜ì²  ë„ìš°ë¯¸</h1>
        <p class="text-lg opacity-90" id="header-subtitle">ì–´ë¨¸ë‹ˆ, ì¦ê±°ìš´ ë‚˜ë“¤ì´ ë˜ì„¸ìš”!</p>
    </header>

    <main class="p-4 space-y-6" id="app">
        <!-- ë©”ì¸ ë©”ë‰´ -->
        <div id="main-menu" class="space-y-6 pt-2">
            <!-- ì¦ê²¨ì°¾ê¸° ì„¹ì…˜ -->
            <div id="favorites-section" class="hidden">
                <h2 class="text-2xl font-black text-gray-700 mb-3 ml-1">â­ ìì£¼ ê°€ì‹œëŠ” ê³³</h2>
                <div id="favorites-list" class="space-y-3">
                    <!-- ì¦ê²¨ì°¾ê¸° ì•„ì´í…œì´ ì—¬ê¸°ì— ì¶”ê°€ë¨ -->
                </div>
            </div>

            <!-- ê¸°ë³¸ ë²„íŠ¼ -->
            <div class="space-y-4">
                <h2 class="text-2xl font-black text-gray-700 mb-3 ml-1">ğŸ” ì—­ ì°¾ê¸°</h2>
                <button onclick="openSearch('departure')" class="big-button w-full bg-white border-4 border-blue-500 rounded-3xl p-6 text-left flex items-center justify-between">
                    <div>
                        <span class="text-gray-500 text-xl block">ì¶œë°œì—­</span>
                        <span id="dep-display" class="text-3xl font-extrabold text-blue-700">êµ¬ë¦¬ì—­</span>
                    </div>
                    <span class="text-4xl">ğŸš©</span>
                </button>

                <button onclick="openSearch('arrival')" class="big-button w-full bg-white border-4 border-green-500 rounded-3xl p-6 text-left flex items-center justify-between">
                    <div>
                        <span class="text-gray-500 text-xl block">ë„ì°©ì—­</span>
                        <span id="arr-display" class="text-3xl font-extrabold text-gray-400 font-normal">ì–´ë””ë¡œ ê°€ì„¸ìš”?</span>
                    </div>
                    <span class="text-4xl">ğŸ“</span>
                </button>
            </div>

            <button id="find-route-btn" onclick="showRouteDetails()" disabled class="w-full bg-gray-300 text-white py-6 rounded-3xl text-3xl font-black shadow-lg">
                ê¸¸ ì°¾ê¸° ì‹œì‘
            </button>
        </div>

        <!-- ê²€ìƒ‰ í™”ë©´ (ì „ì²´í™”ë©´ ì˜¤ë²„ë ˆì´ ëŠë‚Œ) -->
        <div id="search-view" class="hidden fixed inset-0 bg-white z-[60] p-4 flex flex-col">
            <div class="flex items-center gap-4 mb-4">
                <button onclick="closeSearch()" class="text-4xl p-2">âœ•</button>
                <h2 id="search-title" class="text-2xl font-black">ì—­ ì´ë¦„ ê²€ìƒ‰</h2>
            </div>
            
            <input type="text" id="station-input" oninput="filterStations(this.value)" placeholder="ì˜ˆ: ì ì‹¤, ì„œìš¸ì—­" 
                   class="w-full border-4 border-blue-400 rounded-2xl p-5 text-3xl font-bold focus:outline-none focus:border-blue-600 mb-4">
            
            <div id="search-results" class="flex-1 space-y-2">
                <!-- ê²€ìƒ‰ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë¨ -->
            </div>
        </div>

        <!-- ê²½ë¡œ ê²°ê³¼ í™”ë©´ -->
        <div id="route-detail" class="hidden bg-white rounded-3xl border-4 border-blue-400 p-6 shadow-xl space-y-6">
            <div class="flex justify-between items-center">
                <button onclick="goHome()" class="bg-gray-400 text-white px-4 py-2 rounded-xl text-xl font-bold">ì²˜ìŒìœ¼ë¡œ</button>
                <button id="fav-toggle-btn" onclick="toggleFavorite()" class="text-4xl">â˜†</button>
            </div>
            
            <div id="route-content" class="text-center">
                <!-- ê²½ë¡œ ì •ë³´ê°€ í‘œì‹œë¨ -->
            </div>

            <a id="naver-link" target="_blank" class="block w-full bg-green-500 text-white text-center py-5 rounded-2xl text-2xl font-black shadow-lg">
                ë„¤ì´ë²„ ì§€ë„ë¡œ ìì„¸íˆ ë³´ê¸°
            </a>
            <p class="text-center text-gray-500 text-lg font-bold">ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì‹¤ì‹œê°„ ì‹œê°„ì´ ë‚˜ì˜µë‹ˆë‹¤</p>
        </div>
    </main>

    <script>
        // ì£¼ìš” ì—­ ë°ì´í„° (ì„œìš¸ ì§€í•˜ì²  ëª¨ë“  ì£¼ìš” ì—­ í¬í•¨ ì˜ˆì‹œ)
        const allStations = [
            { name: "êµ¬ë¦¬", line: "ê²½ì˜ì¤‘ì•™", color: "line-gj", id: "1000001016" },
            { name: "ì ì‹¤", line: "8", color: "line-8", id: "1000000216" },
            { name: "ì²œí˜¸", line: "8", color: "line-8", id: "1000000811" },
            { name: "ì„œìš¸ì—­", line: "1", color: "line-1", id: "1000000133" },
            { name: "ê°•ë‚¨", line: "2", color: "line-2", id: "1000000222" },
            { name: "ì²­ëŸ‰ë¦¬", line: "ê²½ì˜ì¤‘ì•™", color: "line-gj", id: "1000001014" },
            { name: "í™ëŒ€ì…êµ¬", line: "2", color: "line-2", id: "1000000239" },
            { name: "ê³ ì†í„°ë¯¸ë„", line: "3", color: "line-3", id: "1000000339" },
            { name: "ê°€ë½ì‹œì¥", line: "8", color: "line-8", id: "1000000350" },
            { name: "ë³„ë‚´", line: "8", color: "line-8", id: "1000000826" },
            { name: "ì¥ìí˜¸ìˆ˜ê³µì›", line: "8", color: "line-8", id: "1000000824" },
            { name: "ë™ëŒ€ë¬¸", line: "1", color: "line-1", id: "1000000128" },
            { name: "ìˆ˜ì›", line: "1", color: "line-1", id: "1000000155" },
            { name: "ì™•ì‹­ë¦¬", line: "ê²½ì˜ì¤‘ì•™", color: "line-gj", id: "1000001013" },
            { name: "ì˜¥ìˆ˜", line: "ê²½ì˜ì¤‘ì•™", color: "line-gj", id: "1000001010" }
            // ì‹¤ì œ ì„œë¹„ìŠ¤ ì‹œì—ëŠ” ë” ë§ì€ ì—­ ë°ì´í„°ë¥¼ í¬í•¨í•˜ê±°ë‚˜ ê³µê³µë°ì´í„° APIë¥¼ ì—°ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        ];

        let departure = allStations[0]; // ê¸°ë³¸ êµ¬ë¦¬ì—­
        let arrival = null;
        let searchMode = 'departure';
        let favorites = JSON.parse(localStorage.getItem('guri_subway_favs') || '[]');

        function openSearch(mode) {
            searchMode = mode;
            document.getElementById('search-view').classList.remove('hidden');
            document.getElementById('search-title').innerText = mode === 'departure' ? 'ì–´ë””ì„œ íƒ€ì„¸ìš”?' : 'ì–´ë””ë¡œ ê°€ì„¸ìš”?';
            document.getElementById('station-input').value = '';
            document.getElementById('station-input').focus();
            filterStations('');
        }

        function closeSearch() {
            document.getElementById('search-view').classList.add('hidden');
        }

        function filterStations(query) {
            const container = document.getElementById('search-results');
            container.innerHTML = '';
            
            const filtered = allStations.filter(s => s.name.includes(query));
            
            filtered.forEach(st => {
                const div = document.createElement('button');
                div.className = "w-full bg-white border-2 border-gray-200 p-5 rounded-2xl flex items-center justify-between text-left mb-2";
                div.onclick = () => selectStation(st);
                div.innerHTML = `
                    <span class="text-2xl font-bold">${st.name}ì—­</span>
                    <span class="station-badge ${st.color}">${st.line}</span>
                `;
                container.appendChild(div);
            });
        }

        function selectStation(st) {
            if (searchMode === 'departure') {
                departure = st;
                document.getElementById('dep-display').innerText = st.name + 'ì—­';
                document.getElementById('dep-display').classList.remove('text-gray-400');
                document.getElementById('dep-display').classList.add('text-blue-700');
            } else {
                arrival = st;
                document.getElementById('arr-display').innerText = st.name + 'ì—­';
                document.getElementById('arr-display').classList.remove('text-gray-400');
                document.getElementById('arr-display').classList.add('text-green-700');
            }
            
            checkReady();
            closeSearch();
        }

        function checkReady() {
            const btn = document.getElementById('find-route-btn');
            if (departure && arrival && (departure.id !== arrival.id)) {
                btn.disabled = false;
                btn.classList.remove('bg-gray-300');
                btn.classList.add('bg-blue-600');
            } else {
                btn.disabled = true;
                btn.classList.add('bg-gray-300');
                btn.classList.remove('bg-blue-600');
            }
        }

        function showRouteDetails() {
            document.getElementById('main-menu').classList.add('hidden');
            document.getElementById('route-detail').classList.remove('hidden');
            
            const content = document.getElementById('route-content');
            content.innerHTML = `
                <div class="mb-6">
                    <div class="flex items-center justify-center gap-3 text-3xl font-black text-gray-800">
                        <span class="text-blue-600">${departure.name}</span>
                        <span>â†’</span>
                        <span class="text-green-600">${arrival.name}</span>
                    </div>
                </div>
                <div class="bg-blue-50 p-6 rounded-3xl border-2 border-blue-100">
                    <p class="text-2xl text-gray-700 mb-2 font-bold">íƒ€ì•¼ í•  ë…¸ì„ :</p>
                    <span class="station-badge ${departure.color} text-2xl py-2 px-6 rounded-full">${departure.line}í˜¸ì„ </span>
                    <p class="mt-4 text-xl text-gray-600 leading-relaxed">
                        ${departure.name}ì—­ì—ì„œ <b>${departure.line}í˜¸ì„ </b> ì—´ì°¨ë¥¼ íƒ€ì‹œë©´ ë©ë‹ˆë‹¤.<br>
                        ìì„¸í•œ ì‹œê°„ì€ ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ë³´ì„¸ìš”.
                    </p>
                </div>
            `;
            
            document.getElementById('naver-link').href = `https://map.naver.com/p/subway/1000/${departure.id}/${arrival.id}/-`;
            updateFavoriteStar();
        }

        function goHome() {
            document.getElementById('route-detail').classList.add('hidden');
            document.getElementById('main-menu').classList.remove('hidden');
            renderFavorites();
        }

        // ì¦ê²¨ì°¾ê¸° ê¸°ëŠ¥
        function toggleFavorite() {
            const routeKey = `${departure.id}-${arrival.id}`;
            const index = favorites.findIndex(f => f.key === routeKey);
            
            if (index > -1) {
                favorites.splice(index, 1);
            } else {
                favorites.push({
                    key: routeKey,
                    dep: departure,
                    arr: arrival
                });
            }
            
            localStorage.setItem('guri_subway_favs', JSON.stringify(favorites));
            updateFavoriteStar();
        }

        function updateFavoriteStar() {
            const routeKey = `${departure.id}-${arrival.id}`;
            const isFav = favorites.some(f => f.key === routeKey);
            document.getElementById('fav-toggle-btn').innerText = isFav ? 'â­' : 'â˜†';
            document.getElementById('fav-toggle-btn').style.color = isFav ? '#f59e0b' : '#9ca3af';
        }

        function renderFavorites() {
            const container = document.getElementById('favorites-list');
            const section = document.getElementById('favorites-section');
            
            if (favorites.length === 0) {
                section.classList.add('hidden');
                return;
            }
            
            section.classList.remove('hidden');
            container.innerHTML = '';
            
            favorites.forEach(fav => {
                const btn = document.createElement('button');
                btn.className = "w-full bg-yellow-50 border-2 border-yellow-200 rounded-2xl p-4 flex items-center justify-between shadow-sm";
                btn.onclick = () => {
                    departure = fav.dep;
                    arrival = fav.arr;
                    document.getElementById('dep-display').innerText = departure.name + 'ì—­';
                    document.getElementById('arr-display').innerText = arrival.name + 'ì—­';
                    document.getElementById('arr-display').classList.remove('text-gray-400');
                    document.getElementById('arr-display').classList.add('text-green-700');
                    checkReady();
                    showRouteDetails();
                };
                btn.innerHTML = `
                    <div class="text-left">
                        <span class="text-2xl font-black text-gray-800">${fav.dep.name} â†’ ${fav.arr.name}</span>
                        <div class="mt-1">
                            <span class="station-badge ${fav.dep.color} text-sm">${fav.dep.line}</span>
                        </div>
                    </div>
                    <span class="text-3xl">â¡ï¸</span>
                `;
                container.appendChild(btn);
            });
        }

        // ì´ˆê¸°í™”
        window.onload = renderFavorites;
    </script>
</body>
</html>
