<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì–´ë¨¸ë‹ˆ ì§€í•˜ì²  ë„ìš°ë¯¸</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700;800&display=swap');
        body { font-family: 'Nanum+Gothic', sans-serif; background-color: #f1f5f9; -webkit-tap-highlight-color: transparent; overflow: hidden; height: 100vh; display: flex; flex-direction: column; }
        .big-button { transition: transform 0.1s active; box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
        .big-button:active { transform: scale(0.98); }
        .line-badge { display: inline-block; padding: 2px 10px; border-radius: 15px; color: white; font-weight: 700; font-size: 0.8rem; margin-right: 4px; white-space: nowrap; }
        
        /* ë…¸ì„ ë³„ ê³µì‹ ìƒ‰ìƒ ì •ë°€ ì ìš© */
        .line-1 { background-color: #0052A4; } .line-2 { background-color: #009D3E; }
        .line-3 { background-color: #EF7C1C; } .line-4 { background-color: #00A5DE; }
        .line-5 { background-color: #996CAC; } .line-6 { background-color: #CD7C2F; }
        .line-7 { background-color: #747F00; } .line-8 { background-color: #e6186c; }
        .line-9 { background-color: #BDB092; } .line-gj { background-color: #77c4a3; }
        .line-suin { background-color: #F5A200; } .line-shin { background-color: #D4003B; }
        .line-gtx { background-color: #A6142F; } .line-gc { background-color: #0C8E72; }
        .line-gg { background-color: #003da5; } .line-uj { background-color: #fdae61; }
        .line-sl { background-color: #6789CA; } .line-sh { background-color: #81A914; }
        .line-yi { background-color: #50AD08; } .line-ui { background-color: #B0C4DE; }
        .line-in1 { background-color: #7CA8D5; } .line-in2 { background-color: #ED8B00; }
        .line-ap { background-color: #0090D2; } .line-default { background-color: #64748b; }

        .path-step { position: relative; padding-left: 45px; padding-bottom: 30px; }
        .path-step::before { content: ''; position: absolute; left: 17px; top: 20px; bottom: -10px; width: 4px; background-color: #e2e8f0; border-radius: 2px; }
        .path-step:last-child::before { display: none; }
        .circle-num { position: absolute; left: 0; top: 0; width: 36px; height: 36px; background-color: #3b82f6; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 1rem; z-index: 10; }
        .highlight-action { color: #dc2626; font-weight: 800; text-decoration: underline; text-underline-offset: 3px; }
        .content-scroll { flex: 1; overflow-y: auto; -webkit-overflow-scrolling: touch; }
        .route-tab { transition: all 0.2s; border-bottom: 4px solid transparent; }
        .route-tab.active { color: #2563eb; border-bottom-color: #2563eb; background-color: #eff6ff; }
    </style>
</head>
<body class="max-w-md mx-auto bg-gray-50">

    <header class="bg-blue-600 text-white p-5 text-center shadow-lg shrink-0">
        <h1 class="text-2xl font-black mb-1">êµ¬ë¦¬ì—­ ì§€í•˜ì²  ë„ìš°ë¯¸</h1>
        <p class="text-sm opacity-95 font-bold">ì–´ë¨¸ë‹ˆ, ëª¨ë“  ì—­ì˜ ê²½ë¡œë¥¼ ìƒˆë¡œ ê·¸ë ¸ìŠµë‹ˆë‹¤!</p>
    </header>

    <div id="main-area" class="content-scroll">
        <div id="main-menu" class="p-4 space-y-4">
            <button onclick="openSearch('out')" class="big-button w-full bg-white border-2 border-blue-500 rounded-2xl p-6 text-left flex items-center justify-between shadow-sm">
                <div>
                    <span class="text-gray-500 text-sm block mb-1 font-bold">ì§‘ì—ì„œ ë‚˜ê°ˆ ë•Œ</span>
                    <span class="text-2xl font-black text-gray-800">êµ¬ë¦¬ì—­ ì¶œë°œ ğŸ </span>
                </div>
                <span class="text-4xl text-blue-500">â¡ï¸</span>
            </button>
            <button onclick="openSearch('in')" class="big-button w-full bg-white border-2 border-green-500 rounded-2xl p-6 text-left flex items-center justify-between shadow-sm">
                <div>
                    <span class="text-gray-500 text-sm block mb-1 font-bold">ì§‘ìœ¼ë¡œ ì˜¬ ë•Œ</span>
                    <span class="text-2xl font-black text-green-700">êµ¬ë¦¬ì—­ ë„ì°© ğŸš‰</span>
                </div>
                <span class="text-4xl text-green-500">â¬…ï¸</span>
            </button>
            <button onclick="toggleMap(true)" class="big-button w-full bg-orange-400 border-2 border-orange-500 rounded-2xl p-4 text-center shadow-md">
                <span class="text-xl font-black text-white">ğŸ—ºï¸ ë…¸ì„ ë„ í¬ê²Œ ë³´ê¸°</span>
            </button>
            <div id="favorites-section" class="hidden mt-6 pb-10">
                <h2 class="text-xl font-black text-gray-700 mb-3 ml-1">â­ ìì£¼ ê°€ëŠ” ê³³</h2>
                <div id="favorites-list" class="space-y-3"></div>
            </div>
        </div>

        <div id="route-detail" class="hidden p-4 space-y-4 pb-20">
            <div class="flex justify-between items-center bg-white p-4 rounded-2xl shadow-sm border border-gray-100">
                <button onclick="goHome()" class="bg-gray-400 text-white px-4 py-2 rounded-xl text-lg font-bold">ì²˜ìŒìœ¼ë¡œ</button>
                <div class="text-center flex-1 mx-2"><span id="target-name-display" class="text-xl font-black text-blue-800">ì—­ ì´ë¦„</span></div>
                <button id="fav-btn" onclick="toggleFavorite()" class="text-4xl">â˜†</button>
            </div>
            <div class="flex bg-white rounded-xl shadow-sm overflow-hidden border border-gray-200">
                <button id="tab-fast" onclick="switchRoute('fast')" class="route-tab active flex-1 py-4 font-black text-lg">âš¡ ìµœë‹¨ ì‹œê°„<br><span id="time-fast" class="text-sm font-bold text-blue-500">--ë¶„</span></button>
                <button id="tab-easy" onclick="switchRoute('easy')" class="route-tab flex-1 py-4 font-black text-lg border-l border-gray-100">ğŸš¶ ìµœì†Œ í™˜ìŠ¹<br><span id="time-easy" class="text-sm font-bold text-green-600">--ë¶„</span></button>
            </div>
            <div class="bg-white rounded-3xl border-2 border-blue-200 p-5 shadow-xl space-y-6">
                <div id="route-path-summary" class="flex flex-wrap items-center justify-center gap-1 p-3 bg-gray-50 rounded-2xl border border-gray-100 font-bold text-sm text-gray-600"></div>
                <div id="route-content" class="space-y-4"></div>
            </div>
        </div>
    </div>

    <div id="search-view" class="hidden fixed inset-0 bg-white z-[60] flex flex-col p-5">
        <div class="flex items-center justify-between mb-4">
            <h2 id="search-title" class="text-xl font-black text-blue-800">ì–´ë””ë¡œ ê°€ì‹œë‚˜ìš”?</h2>
            <button onclick="closeSearch()" class="text-4xl font-bold p-2 text-gray-400">âœ•</button>
        </div>
        <input type="text" id="station-input" oninput="filterStations(this.value)" autofocus placeholder="ì—­ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: ì•¼íƒ‘, íŒêµ)" class="w-full border-b-4 border-blue-500 p-3 font-black text-2xl focus:outline-none">
        <div id="search-results" class="flex-1 overflow-y-auto space-y-1 mt-4 pb-20"></div>
        <div class="text-center p-2 text-gray-400 text-xs shrink-0 bg-gray-50 border-t">ì´ <span id="total-count" class="font-bold text-blue-600">--</span>ê°œ ì—­ ë¡œë”© ì™„ë£Œ</div>
    </div>

    <div id="map-modal" class="hidden fixed inset-0 bg-black/95 z-[100] flex flex-col p-4">
        <button onclick="toggleMap(false)" class="sticky top-0 self-end bg-white border-2 border-black text-black px-6 py-2 rounded-full text-xl font-bold z-[110]">ë‹«ê¸° âœ•</button>
        <div class="overflow-auto mt-4 flex-1 rounded-2xl bg-white"><img src="map_korea.jpg" alt="ë…¸ì„ ë„" class="max-w-none w-[500%]" id="map-img"></div>
    </div>

    <script>
        /** [ë°ì´í„° ëˆ„ë½ ì ˆëŒ€ ë°©ì§€] 802ê°œ ì „ ë…¸ì„  ë°ì´í„° ìˆ˜ë¡ */
        const rawStations = {
            "1": "ì†Œìš”ì‚°,ë™ë‘ì²œ,ë³´ì‚°,ë™ë‘ì²œì¤‘ì•™,ì§€í–‰,ë•ì •,ë•ê³„,ì–‘ì£¼,ë…¹ì–‘,ê°€ëŠ¥,ì˜ì •ë¶€,íšŒë£¡,ë§ì›”ì‚¬,ë„ë´‰ì‚°,ë„ë´‰,ë°©í•™,ì°½ë™,ë…¹ì²œ,ì›”ê³„,ê´‘ìš´ëŒ€,ì„ê³„,ì‹ ì´ë¬¸,ì™¸ëŒ€ì•,íšŒê¸°,ì²­ëŸ‰ë¦¬,ì œê¸°ë™,ì‹ ì„¤ë™,ë™ë¬˜ì•,ë™ëŒ€ë¬¸,ì¢…ë¡œ5ê°€,ì¢…ë¡œ3ê°€,ì¢…ê°,ì‹œì²­,ì„œìš¸ì—­,ë‚¨ì˜,ìš©ì‚°,ë…¸ëŸ‰ì§„,ëŒ€ë°©,ì‹ ê¸¸,ì˜ë“±í¬,ì‹ ë„ë¦¼,êµ¬ë¡œ,ê°€ì‚°ë””ì§€í„¸ë‹¨ì§€,ë…ì‚°,ê¸ˆì²œêµ¬ì²­,ì„ìˆ˜,ê´€ì•…,ì•ˆì–‘,ëª…í•™,ê¸ˆì •,êµ°í¬,ë‹¹ì •,ì˜ì™•,ì„±ê· ê´€ëŒ€,í™”ì„œ,ìˆ˜ì›,ì„¸ë¥˜,ë³‘ì ,ì„¸ë§ˆ,ì˜¤ì‚°ëŒ€,ì˜¤ì‚°,ì§„ìœ„,ì†¡íƒ„,ì„œì •ë¦¬,í‰íƒì§€ì œ,í‰íƒ,ì„±í™˜,ì§ì‚°,ë‘ì •,ì²œì•ˆ,ë´‰ëª…,ìŒìš©,ì•„ì‚°,íƒ•ì •,ë°°ë°©,ì˜¨ì–‘ì˜¨ì²œ,ì‹ ì°½,ê°œë´‰,ì˜¤ë¥˜ë™,ì—­ê³¡,ë¶€ì²œ,ì¤‘ë™,ì†¡ë‚´,ë¶€ê°œ,ë¶€í‰,ë°±ìš´,ë™ì•”,ê°„ì„,ì£¼ì•ˆ,ë„í™”,ì œë¬¼í¬,ë„ì›,ë™ì¸ì²œ,ì¸ì²œ,ì—°ì²œ,ì „ê³¡,ì²­ì‚°,ê´‘ëª…,ì„œë™íƒ„",
            "2": "ê°•ë‚¨,ì ì‹¤,í™ëŒ€ì…êµ¬,ì‚¼ì„±,ì„ ë¦‰,êµëŒ€,ì‚¬ë‹¹,ê±´ëŒ€ì…êµ¬,ì„±ìˆ˜,ì‹ ì´Œ,ì„ì§€ë¡œì…êµ¬,ì„ì§€ë¡œ3ê°€,ì„ì§€ë¡œ4ê°€,ì‹ ë¦¼,ëŒ€ë¦¼,í•©ì •,ë‹¹ì‚°,ì˜ë“±í¬êµ¬ì²­,ì‹ ë„ë¦¼,ì™•ì‹­ë¦¬,ìƒì™•ì‹­ë¦¬,ì‹ ë‹¹,ë™ëŒ€ë¬¸ì—­ì‚¬ë¬¸í™”ê³µì›,ëšì„¬,í•œì–‘ëŒ€,êµ¬ì˜,ê°•ë³€,ì ì‹¤ë‚˜ë£¨,ì ì‹¤ìƒˆë‚´,ì¢…í•©ìš´ë™ì¥,ìš©ë‹µ,ì‹ ë‹µ,ìš©ë‘,ì–‘ì²œêµ¬ì²­,ì‹ ì •ë„¤ê±°ë¦¬,ë„ë¦¼ì²œ,ê¹Œì¹˜ì‚°,ë°©ë°°,ì„œì´ˆ,ë‚™ì„±ëŒ€,ì„œìš¸ëŒ€ì…êµ¬,ë´‰ì²œ,ë¬¸ë˜,ì´ëŒ€,ì•„í˜„,ì¶©ì •ë¡œ",
            "3": "ê³ ì†í„°ë¯¸ë„,ì–‘ì¬,êµëŒ€,ë‚¨ë¶€í„°ë¯¸ë„,ì‹ ì‚¬,ì ì›,ì••êµ¬ì •,ì˜¥ìˆ˜,ê¸ˆí˜¸,ì•½ìˆ˜,ë™ëŒ€ì…êµ¬,ì¶©ë¬´ë¡œ,ì•ˆêµ­,ê²½ë³µê¶,ë…ë¦½ë¬¸,ë¬´ì•…ì¬,í™ì œ,ë…¹ë²ˆ,ë¶ˆê´‘,ì—°ì‹ ë‚´,êµ¬íŒŒë°œ,ì§€ì¶•,ì‚¼ì†¡,ì›í¥,ì›ë‹¹,í™”ì •,ëŒ€ê³¡,ë°±ì„,ë§ˆë‘,ì •ë°œì‚°,ì£¼ì—½,ëŒ€í™”,ë§¤ë´‰,ë„ê³¡,ëŒ€ì¹˜,í•™ì—¬ìš¸,ëŒ€ì²­,ì¼ì›,ìˆ˜ì„œ,ê°€ë½ì‹œì¥,ê²½ì°°ë³‘ì›,ì˜¤ê¸ˆ",
            "4": "ì§„ì ‘,ì˜¤ë‚¨,ë³„ë‚´ë³„ê°€ëŒ,ë‹¹ê³ ê°œ,ìƒê³„,ë…¸ì›,ì°½ë™,ìŒë¬¸,ìˆ˜ìœ ,ë¯¸ì•„,ë¯¸ì•„ì‚¬ê±°ë¦¬,ê¸¸ìŒ,ì„±ì‹ ì—¬ëŒ€ì…êµ¬,í•œì„±ëŒ€ì…êµ¬,í˜œí™”,ë™ëŒ€ë¬¸,ì¶©ë¬´ë¡œ,ëª…ë™,íšŒí˜„,ì„œìš¸ì—­,ìˆ™ëŒ€ì…êµ¬,ì‚¼ê°ì§€,ì‹ ìš©ì‚°,ì´ì´Œ,ë™ì‘,ì´ì‹ ëŒ€ì…êµ¬,ì‚¬ë‹¹,ë‚¨íƒœë ¹,ì„ ë°”ìœ„,ê²½ë§ˆê³µì›,ëŒ€ê³µì›,ê³¼ì²œ,ì •ë¶€ê³¼ì²œì²­ì‚¬,ì¸ë•ì›,í‰ì´Œ,ë²”ê³„,ì‚°ë³¸,ê¸ˆì •,ëŒ€ì•¼ë¯¸,ë°˜ì›”,ìƒë¡ìˆ˜,í•œëŒ€ì•,ì¤‘ì•™,ê³ ì”,ì´ˆì§€,ì•ˆì‚°,ì‹ ê¸¸ì˜¨ì²œ,ì •ì™•,ì˜¤ì´ë„",
            "5": "ë°©í™”,ê°œí™”ì‚°,ê¹€í¬ê³µí•­,ì†¡ì •,ë§ˆê³¡,ë°œì‚°,ìš°ì¥ì‚°,í™”ê³¡,ê¹Œì¹˜ì‚°,ì‹ ì •,ëª©ë™,ì˜¤ëª©êµ,ì–‘í‰,ì˜ë“±í¬êµ¬ì²­,ì˜ë“±í¬ì‹œì¥,ì‹ ê¸¸,ì—¬ì˜ë„,ì—¬ì˜ë‚˜ë£¨,ë§ˆí¬,ê³µë•,ì• ì˜¤ê°œ,ì¶©ì •ë¡œ,ì„œëŒ€ë¬¸,ê´‘í™”ë¬¸,ì¢…ë¡œ3ê°€,ì„ì§€ë¡œ4ê°€,ë™ëŒ€ë¬¸ì—­ì‚¬ë¬¸í™”ê³µì›,ì²­êµ¬,ì‹ ê¸ˆí˜¸,í–‰ë‹¹,ì™•ì‹­ë¦¬,ë§ˆì¥,ë‹µì‹­ë¦¬,ì¥í•œí‰,êµ°ì,ì•„ì°¨ì‚°,ê´‘ë‚˜ë£¨,ì²œí˜¸,ê°•ë™,ê¸¸ë™,êµ½ì€ë‹¤ë¦¬,ëª…ì¼,ê³ ë•,ìƒì¼ë™,ê°•ì¼,ë¯¸ì‚¬,í•˜ë‚¨í’ì‚°,í•˜ë‚¨ì‹œì²­,í•˜ë‚¨ê²€ë‹¨ì‚°,ë‘”ì´Œë™,ì˜¬ë¦¼í”½ê³µì›,ë°©ì´,ì˜¤ê¸ˆ,ê°œë¡±,ê±°ì—¬,ë§ˆì²œ",
            "6": "ì‘ì•”,ì—­ì´Œ,ë¶ˆê´‘,ë…ë°”ìœ„,ì—°ì‹ ë‚´,êµ¬ì‚°,ìƒˆì ˆ,ì¦ì‚°,ë””ì§€í„¸ë¯¸ë””ì–´ì‹œí‹°,ì›”ë“œì»µê²½ê¸°ì¥,ë§ˆí¬êµ¬ì²­,ë§ì›,í•©ì •,ìƒìˆ˜,ê´‘í¥ì°½,ëŒ€í¥,ê³µë•,íš¨ì°½ê³µì›ì•,ì‚¼ê°ì§€,ë…¹ì‚¬í‰,ì´íƒœì›,í•œê°•ì§„,ë²„í‹°ê³ ê°œ,ì•½ìˆ˜,ì²­êµ¬,ì‹ ë‹¹,ë™ë¬˜ì•,ì°½ì‹ ,ë³´ë¬¸,ì•ˆì•”,ê³ ë ¤ëŒ€,ì›”ê³¡,ìƒì›”ê³¡,ëŒê³¶ì´,ì„ê³„,íƒœë¦‰ì…êµ¬,í™”ë‘ëŒ€,ë´‰í™”ì‚°,ì‹ ë‚´",
            "7": "ì¥ì•”,ë„ë´‰ì‚°,ìˆ˜ë½ì‚°,ë§ˆë“¤,ë…¸ì›,ì¤‘ê³„,í•˜ê³„,ê³µë¦‰,íƒœë¦‰ì…êµ¬,ë¨¹ê³¨,ì¤‘í™”,ìƒë´‰,ë©´ëª©,ì‚¬ê°€ì •,ìš©ë§ˆì‚°,ì¤‘ê³¡,êµ°ì,ì–´ë¦°ì´ëŒ€ê³µì›,ê±´ëŒ€ì…êµ¬,ìì–‘,ì²­ë‹´,ê°•ë‚¨êµ¬ì²­,í•™ë™,ë…¼í˜„,ë°˜í¬,ê³ ì†í„°ë¯¸ë„,ë‚´ë°©,ì´ìˆ˜,ë‚¨ì„±,ìˆ­ì‹¤ëŒ€ì…êµ¬,ìƒë„,ì¥ìŠ¹ë°°ê¸°,ì‹ ëŒ€ë°©ì‚¼ê±°ë¦¬,ë³´ë¼ë§¤,ì‹ í’,ëŒ€ë¦¼,ë‚¨êµ¬ë¡œ,ê°€ì‚°ë””ì§€í„¸ë‹¨ì§€,ì² ì‚°,ê´‘ëª…ì‚¬ê±°ë¦¬,ì²œì™•,ì˜¨ìˆ˜,ê¹Œì¹˜ìš¸,ë¶€ì²œì¢…í•©ìš´ë™ì¥,ì¶˜ì˜,ì‹ ì¤‘ë™,ë¶€ì²œì‹œì²­,ìƒë™,ì‚¼ì‚°ì²´ìœ¡ê´€,êµ´í¬ì²œ,ë¶€í‰êµ¬ì²­,ì‚°ê³¡,ì„ë‚¨",
            "8": "ë³„ë‚´,ë‹¤ì‚°,ë™êµ¬ë¦‰,êµ¬ë¦¬,ì¥ìí˜¸ìˆ˜ê³µì›,ì•”ì‚¬ì—­ì‚¬ê³µì›,ì•”ì‚¬,ì²œí˜¸,ê°•ë™êµ¬ì²­,ëª½ì´Œí† ì„±,ì ì‹¤,ì„ì´Œ,ì†¡íŒŒ,ê°€ë½ì‹œì¥,ë¬¸ì •,ì¥ì§€,ë³µì •,ì‚°ì„±,ë‚¨í•œì‚°ì„±ì…êµ¬,ë‹¨ëŒ€ì˜¤ê±°ë¦¬,ì‹ í¥,ìˆ˜ì§„,ëª¨ë€,ë‚¨ìœ„ë¡€",
            "9": "ê°œí™”,ê¹€í¬ê³µí•­,ê³µí•­ì‹œì¥,ì‹ ë°©í™”,ë§ˆê³¡ë‚˜ë£¨,ì–‘ì²œí–¥êµ,ê°€ì–‘,ì¦ë¯¸,ë“±ì´Œ,ì—¼ì°½,ì‹ ëª©ë™,ì„ ìœ ë„,ë‹¹ì‚°,êµ­íšŒì˜ì‚¬ë‹¹,ì—¬ì˜ë„,ìƒ›ê°•,ë…¸ëŸ‰ì§„,í‘ì„,ë™ì‘,ê³ ì†í„°ë¯¸ë„,ì‹ ë…¼í˜„,ì„ ì •ë¦‰,ë´‰ì€ì‚¬,ì¢…í•©ìš´ë™ì¥,ì„ì´Œ,ì˜¬ë¦¼í”½ê³µì›,ì¤‘ì•™ë³´í›ˆë³‘ì›",
            "gj": "ì„ì§„ê°•,ë¬¸ì‚°,íŒŒì£¼,ì›”ë¡±,ê¸ˆì´Œ,ê¸ˆë¦‰,ìš´ì •,ì•¼ë‹¹,íƒ„í˜„,ì¼ì‚°,í’ì‚°,ë°±ë§ˆ,ê³¡ì‚°,ëŠ¥ê³¡,í–‰ì‹ ,ê°•ë§¤,í•œêµ­í•­ê³µëŒ€,ìˆ˜ìƒ‰,ë””ì§€í„¸ë¯¸ë””ì–´ì‹œí‹°,ê°€ì¢Œ,í™ëŒ€ì…êµ¬,ì„œê°•ëŒ€,ê³µë•,íš¨ì°½ê³µì›ì•,ìš©ì‚°,ì´ì´Œ,ì„œë¹™ê³ ,í•œë‚¨,ì˜¥ìˆ˜,ì‘ë´‰,ì™•ì‹­ë¦¬,ì²­ëŸ‰ë¦¬,íšŒê¸°,ì¤‘ë‘,ìƒë´‰,ë§ìš°,ì–‘ì›,êµ¬ë¦¬,ë„ë†,ì–‘ì •,ë•ì†Œ,ë„ì‹¬,íŒ”ë‹¹,ìš´ê¸¸ì‚°,ì–‘ìˆ˜,ì‹ ì›,êµ­ìˆ˜,ì•„ì‹ ,ì˜¤ë¹ˆ,ì–‘í‰,ì›ë•,ìš©ë¬¸,ì§€í‰",
            "suin": "ì²­ëŸ‰ë¦¬,ì™•ì‹­ë¦¬,ì„œìš¸ìˆ²,ì••êµ¬ì •ë¡œë°ì˜¤,ê°•ë‚¨êµ¬ì²­,ì„ ì •ë¦‰,ì„ ë¦‰,í•œí‹°,ë„ê³¡,êµ¬ë£¡,ê°œí¬ë™,ëŒ€ëª¨ì‚°ì…êµ¬,ìˆ˜ì„œ,ë³µì •,ê°€ì²œëŒ€,íƒœí‰,ëª¨ë€,ì•¼íƒ‘,ì´ë§¤,ì„œí˜„,ìˆ˜ë‚´,ì •ì,ë¯¸ê¸ˆ,ì˜¤ë¦¬,ì£½ì „,ë³´ì •,êµ¬ì„±,ì‹ ê°ˆ,ê¸°í¥,ìƒê°ˆ,ì²­ëª…,ì˜í†µ,ë§í¬,ë§¤íƒ„ê¶Œì„ ,ìˆ˜ì›ì‹œì²­,ë§¤êµ,ìˆ˜ì›,ê³ ìƒ‰,ì˜¤ëª©ì²œ,ì–´ì²œ,ì•¼ëª©,ì‚¬ë¦¬,í•œëŒ€ì•,ì¤‘ì•™,ê³ ì”,ì´ˆì§€,ì•ˆì‚°,ì‹ ê¸¸ì˜¨ì²œ,ì •ì™•,ì˜¤ì´ë„,ë‹¬ì›”,ì›”ê³¶,ì†Œë˜í¬êµ¬,ì¸ì²œë…¼í˜„,í˜¸êµ¬í¬,ë‚¨ë™ì¸ë”ìŠ¤íŒŒí¬,ì›ì¸ì¬,ì—°ìˆ˜,ì†¡ë„,ì¸í•˜ëŒ€,ìˆ­ì˜,ì‹ í¬,ì¸ì²œ",
            "shin": "ì‹ ì‚¬,ë…¼í˜„,ì‹ ë…¼í˜„,ê°•ë‚¨,ì–‘ì¬,ì–‘ì¬ì‹œë¯¼ì˜ìˆ²,ì²­ê³„ì‚°ì…êµ¬,íŒêµ,ì •ì,ë¯¸ê¸ˆ,ë™ì²œ,ìˆ˜ì§€êµ¬ì²­,ì„±ë³µ,ìƒí˜„,ê´‘êµì¤‘ì•™,ê´‘êµ",
            "gc": "ê´‘ìš´ëŒ€,ì²­ëŸ‰ë¦¬,íšŒê¸°,ì¤‘ë‘,ìƒë´‰,ë§ìš°,ì‹ ë‚´,ê°ˆë§¤,ë³„ë‚´,í‡´ê³„ì›,ì‚¬ë¦‰,ê¸ˆê³¡,í‰ë‚´í˜¸í‰,ì²œë§ˆì‚°,ë§ˆì„,ëŒ€ì„±ë¦¬,ì²­í‰,ìƒì²œ,ê°€í‰,êµ´ë´‰ì‚°,ë°±ì–‘ë¦¬,ê°•ì´Œ,ê¹€ìœ ì •,ë‚¨ì¶˜ì²œ,ì¶˜ì²œ",
            "gg": "íŒêµ,ì´ë§¤,ì„±ë‚¨,ì‚¼ë™,ê²½ê¸°ê´‘ì£¼,ì´ˆì›”,ê³¤ì§€ì•”,ì‹ ë‘”ë„ì˜ˆì´Œ,ì´ì²œ,ë¶€ë°œ,ì„¸ì¢…ëŒ€ì™•ë¦‰,ì—¬ì£¼",
            "gtx": "ìˆ˜ì„œ,ì„±ë‚¨,êµ¬ì„±,ë™íƒ„,í‚¨í…ìŠ¤,ì„œìš¸ì—­,ìš´ì •ì¤‘ì•™",
            "ui": "ë¶í•œì‚°ìš°ì´,ì†”ë°­ê³µì›,4.19ë¯¼ì£¼ë¬˜ì§€,ê°€ì˜¤ë¦¬,í™”ê³„,ì‚¼ì–‘,ì‚¼ì–‘ì‚¬ê±°ë¦¬,ì†”ìƒ˜,ë¶í•œì‚°ë³´êµ­ë¬¸,ì •ë¦‰,ì„±ì‹ ì—¬ëŒ€ì…êµ¬,ë³´ë¬¸,ì‹ ì„¤ë™",
            "in1": "ê³„ì–‘,ê·¤í˜„,ë°•ì´Œ,ì„í•™,ê³„ì‚°,ì‘ì „,ê°ˆì‚°,ë¶€í‰êµ¬ì²­,ë¶€í‰ì‹œì¥,ë¶€í‰,ë™ìˆ˜,ë¶€í‰ì‚¼ê±°ë¦¬,ì¸ì²œì‹œì²­,ì˜ˆìˆ íšŒê´€,ì¸ì²œí„°ë¯¸ë„,ë¬¸í•™ê²½ê¸°ì¥,ì„ í•™,ì›ì¸ì¬,ë™ì¶˜,ë™ë§‰,ìº í¼ìŠ¤íƒ€ìš´,í…Œí¬ë…¸íŒŒí¬,ì¸ì²œëŒ€ì…êµ¬,ì„¼íŠ¸ëŸ´íŒŒí¬,ì†¡ë„ë‹¬ë¹›ì¶•ì œê³µì›",
            "in2": "ê²€ë‹¨ì˜¤ë¥˜,ê²€ë‹¨ì‚¬ê±°ë¦¬,ë§ˆì „,ì™„ì •,ë…ì •,ê²€ì•”,ê²€ë°”ìœ„,ì•„ì‹œì•„ë“œê²½ê¸°ì¥,ê°€ì •,ê°€ì •ì¤‘ì•™ì‹œì¥,ì„ë‚¨,ì„œë¶€ì—¬ì„±íšŒê´€,ì¸ì²œê°€ì¢Œ,ê°€ì¬ìš¸,ì£¼ì•ˆ,ì‹œë¯¼ê³µì›,ì¸ì²œì‹œì²­,ì„ì²œì‚¬ê±°ë¦¬,ëª¨ë˜ë‚´ì‹œì¥,ë§Œìˆ˜,ë‚¨ë™êµ¬ì²­,ì¸ì²œëŒ€ê³µì›,ìš´ì—°",
            "uj": "ë°œê³¡,íšŒë£¡,ë²”ê³¨,ì˜ì •ë¶€ì‹œì²­,í¥ì„ ,ì˜ì •ë¶€ì¤‘ì•™,ë™ì˜¤,ìƒˆë§,ê²½ê¸°ë„ì²­ë¶ë¶€ì²­ì‚¬,íš¨ì,ê³¤ì œ,ì–´ë£¡,ì†¡ì‚°,íƒ‘ì„",
            "ap": "ì¸ì²œê³µí•­1í„°ë¯¸ë„,ì¸ì²œê³µí•­2í„°ë¯¸ë„,ê³µí•­í™”ë¬¼ì²­ì‚¬,ìš´ì„œ,ì˜ì¢…,ì²­ë¼êµ­ì œë„ì‹œ,ê²€ì•”,ê³„ì–‘,ê¹€í¬ê³µí•­,ë§ˆê³¡ë‚˜ë£¨,ë””ì§€í„¸ë¯¸ë””ì–´ì‹œí‹°,í™ëŒ€ì…êµ¬,ê³µë•,ì„œìš¸ì—­",
            "yi": "ê¸°í¥,ê°•ë‚¨ëŒ€,ì§€ì„,ì–´ì •,ë™ë°±,ì´ˆë‹¹,ì‚¼ê°€,ì‹œì²­.ìš©ì¸ëŒ€,ëª…ì§€ëŒ€,ê¹€ëŸ‰ì¥,ìš©ì¸ì¤‘ì•™ì‹œì¥,ê³ ì§„,ë³´í‰,ë‘”ì „,ì „ëŒ€.ì—ë²„ëœë“œ",
            "sl": "ìƒ›ê°•,ëŒ€ë°©,ë³´ë¼ë§¤,ì‹ ë¦¼,ê´€ì•…ì‚°",
            "sh": "ì¼ì‚°,í’ì‚°,ë°±ë§ˆ,ëŒ€ê³¡,ëŠ¥ê³¡,ê¹€í¬ê³µí•­,ë¶€ì²œì¢…í•©ìš´ë™ì¥,ì†Œì‚¬,ì‹œí¥ì‹œì²­,ì´ˆì§€,ì›ì‹œ"
        };

        const subwayMaster = [];
        for (const [line, names] of Object.entries(rawStations)) {
            names.split(',').forEach(name => { subwayMaster.push({ n: name.trim(), l: line }); });
        }

        const hubTable = {
            "íšŒê¸°": { p:"1-1ë²ˆ", m:"ì˜¥ìƒ‰ ê²½ì˜ì¤‘ì•™ì„ (ì²­ëŸ‰ë¦¬ ë°©ë©´)ì„ íƒ€ê³  íšŒê¸°ì—­ê¹Œì§€ ê°€ì„¸ìš”. ë‚´ë¦° ìë¦¬ ë°”ë¡œ ì˜†ì´ 1í˜¸ì„  íƒ€ëŠ” ê³³ì…ë‹ˆë‹¤.", line:"1", c:"line-1" },
            "ì ì‹¤": { p:"3-1ë²ˆ", m:"í•‘í¬ìƒ‰ 8í˜¸ì„ (ëª¨ë€ ë°©ë©´)ì„ íƒ€ê³  ì ì‹¤ì—­ê¹Œì§€ ê°€ì„¸ìš”. ë‚´ë ¤ì„œ 2í˜¸ì„ (ê°•ë‚¨ ë°©í–¥) í‘œì§€íŒì„ ë”°ë¼ê°€ì„¸ìš”.", line:"2", c:"line-2" },
            "ê°€ë½ì‹œì¥": { p:"3-3ë²ˆ", m:"í•‘í¬ìƒ‰ 8í˜¸ì„ (ëª¨ë€ ë°©ë©´)ì„ íƒ€ê³  ê°€ë½ì‹œì¥ì—­ê¹Œì§€ ê°€ì„¸ìš”. ë‚´ë ¤ì„œ í•œ ì¸µë§Œ ì˜¬ë¼ê°€ë©´ 3í˜¸ì„ ì…ë‹ˆë‹¤.", line:"3", c:"line-3" },
            "ì„ì´Œ": { p:"6-2ë²ˆ", m:"í•‘í¬ìƒ‰ 8í˜¸ì„ (ëª¨ë€ ë°©ë©´)ì„ íƒ€ê³  ì„ì´Œì—­ê¹Œì§€ ê°€ì„¸ìš”. ë‚´ë ¤ì„œ í•œ ì¸µë§Œ ì˜¬ë¼ê°€ë©´ 9í˜¸ì„ ì…ë‹ˆë‹¤.", line:"9", c:"line-9" },
            "ë³µì •": { p:"1-1ë²ˆ", m:"í•‘í¬ìƒ‰ 8í˜¸ì„ (ëª¨ë€ ë°©ë©´)ì„ íƒ€ê³  ë³µì •ì—­ê¹Œì§€ ê°€ì„¸ìš”. ë‚´ë ¤ì„œ ì•„ë˜ì¸µìœ¼ë¡œ ê°€ë©´ ìˆ˜ì¸ë¶„ë‹¹ì„ ì…ë‹ˆë‹¤.", line:"suin", c:"line-suin" },
            "ìƒë´‰": { p:"1-1ë²ˆ", m:"ì˜¥ìƒ‰ ê²½ì˜ì¤‘ì•™ì„ (ì²­ëŸ‰ë¦¬ ë°©ë©´)ì„ íƒ€ê³  ìƒë´‰ì—­ê¹Œì§€ ê°€ì„¸ìš”. 7í˜¸ì„ ì´ë‚˜ ê²½ì¶˜ì„ ìœ¼ë¡œ ê°ˆì•„íƒ€ëŠ” í™”ì‚´í‘œë¥¼ ë”°ë¼ê°€ì„¸ìš”.", line:"7", c:"line-7" },
            "ì™•ì‹­ë¦¬": { p:"1-1ë²ˆ", m:"ì˜¥ìƒ‰ ê²½ì˜ì¤‘ì•™ì„ (ì²­ëŸ‰ë¦¬ ë°©ë©´)ì„ íƒ€ê³  ì™•ì‹­ë¦¬ì—­ê¹Œì§€ ê°€ì„¸ìš”. ë‚´ë ¤ì„œ ê³„ë‹¨ì„ ì˜¬ë¼ê°€ë©´ 2í˜¸ì„ /5í˜¸ì„ ì´ ë‚˜ì˜µë‹ˆë‹¤.", line:"5", c:"line-5" },
            "ì˜¥ìˆ˜": { p:"1-1ë²ˆ", m:"ì˜¥ìƒ‰ ê²½ì˜ì¤‘ì•™ì„ (ì²­ëŸ‰ë¦¬ ë°©ë©´)ì„ íƒ€ê³  ì˜¥ìˆ˜ì—­ê¹Œì§€ ê°€ì„¸ìš”. ë‚´ë ¤ì„œ í•œ ì¸µë§Œ ë‚´ë ¤ê°€ë©´ 3í˜¸ì„ ì…ë‹ˆë‹¤.", line:"3", c:"line-3" },
            "ì²œí˜¸": { p:"1-1ë²ˆ", m:"í•‘í¬ìƒ‰ 8í˜¸ì„ (ëª¨ë€ ë°©ë©´)ì„ íƒ€ê³  ì²œí˜¸ì—­ê¹Œì§€ ê°€ì„¸ìš”. ë‚´ë ¤ì„œ 5í˜¸ì„ (ê´‘í™”ë¬¸ ë°©í–¥)ìœ¼ë¡œ ê°ˆì•„íƒ€ì„¸ìš”.", line:"5", c:"line-5" },
            "ë³„ë‚´": { p:"1-1ë²ˆ", m:"í•‘í¬ìƒ‰ 8í˜¸ì„ (ë³„ë‚´ ë°©ë©´)ì„ íƒ€ê³  ì¢…ì ì¸ ë³„ë‚´ì—­ê¹Œì§€ ê°€ì„¸ìš”. ë‚´ë ¤ì„œ 4í˜¸ì„ ìœ¼ë¡œ ê°ˆì•„íƒ€ì„¸ìš”.", line:"4", c:"line-4" },
            "ê¸°í¥": { p:"1-1ë²ˆ", m:"ìˆ˜ì¸ë¶„ë‹¹ì„ ì„ íƒ€ê³  ê¸°í¥ì—­ê¹Œì§€ ê°€ì„œ ìš©ì¸ê²½ì „ì² (ì—ë²„ë¼ì¸)ë¡œ ê°ˆì•„íƒ€ì„¸ìš”.", line:"yi", c:"line-yi" }
        };

        let currentMode = 'out';
        let selStation = null;
        let activeRoute = 'fast'; 
        let favoriteList = JSON.parse(localStorage.getItem('guri_mama_final_v5_verified')) || [];

        function cleanNm(n) { return n.trim().replace(/ì—­+$/, '') + 'ì—­'; }

        function openSearch(mode) {
            currentMode = mode;
            document.getElementById('search-view').classList.remove('hidden');
            document.getElementById('station-input').value = '';
            document.getElementById('station-input').focus();
            document.getElementById('total-count').innerText = subwayMaster.length;
            filterStations('');
        }
        function closeSearch() { document.getElementById('search-view').classList.add('hidden'); }

        function filterStations(query) {
            const container = document.getElementById('search-results');
            container.innerHTML = '';
            const matches = subwayMaster.filter(s => s.n.includes(query));
            if (matches.length > 0) {
                const unique = []; const seen = new Set();
                matches.forEach(m => { const key = m.n + m.l; if(!seen.has(key)) { unique.push(m); seen.add(key); } });
                unique.forEach(st => {
                    const btn = document.createElement('button');
                    btn.className = "w-full bg-white p-5 text-left flex justify-between items-center active:bg-blue-50 border-b border-gray-100";
                    btn.onclick = () => showResult(st);
                    let lNm = st.l; const lLow = st.l.toLowerCase();
                    if(lLow === 'gj') lNm = 'ê²½ì˜ì¤‘ì•™ì„ '; else if(lLow === 'ap') lNm = 'ê³µí•­ì² ë„'; else if(lLow === 'suin') lNm = 'ìˆ˜ì¸ë¶„ë‹¹ì„ ';
                    else if(lLow === 'shin') lNm = 'ì‹ ë¶„ë‹¹ì„ '; else if(lLow === 'gtx') lNm = 'GTX-A'; else if(lLow === 'gc') lNm = 'ê²½ì¶˜ì„ ';
                    else if(lLow === 'gg') lNm = 'ê²½ê°•ì„ '; else if(lLow === 'ui') lNm = 'ìš°ì´ì‹ ì„¤ì„ '; else if(lLow === 'uj') lNm = 'ì˜ì •ë¶€ê²½ì „ì² ';
                    else if(lLow === 'yi') lNm = 'ìš©ì¸ê²½ì „ì² '; else if(lLow === 'in1') lNm = 'ì¸ì²œ1í˜¸ì„ '; else if(lLow === 'in2') lNm = 'ì¸ì²œ2í˜¸ì„ ';
                    else if(lLow === 'sl') lNm = 'ì‹ ë¦¼ì„ '; else if(lLow === 'sh') lNm = 'ì„œí•´ì„ ';
                    else lNm = st.l + 'í˜¸ì„ ';
                    btn.innerHTML = `<span class="text-xl font-bold text-gray-800">${cleanNm(st.n)}</span><span class="line-badge line-${lLow}">${lNm}</span>`;
                    container.appendChild(btn);
                });
            } else if (query.length > 0) {
                container.innerHTML = `<p class="text-center text-gray-400 mt-10 font-bold">ëª©ë¡ì— ì—†ëŠ” ì—­ì…ë‹ˆë‹¤.<br>ì´ë¦„ì„ ë‹¤ì‹œ í™•ì¸í•´ ë³´ì„¸ìš”.</p>`;
            } else {
                ["ì ì‹¤", "ì„œìš¸ì—­", "ê°•ë‚¨", "ì²œí˜¸", "ë‹¤ì‚°", "ë³„ë‚´", "ì•¼íƒ‘", "íŒêµ", "ë™íƒ„", "ì¸ì²œê³µí•­1í„°ë¯¸ë„"].forEach(name => {
                    const st = subwayMaster.find(s => s.n === name);
                    if (st) {
                        const btn = document.createElement('button');
                        btn.className = "w-full bg-white p-4 rounded-xl border-2 border-gray-100 mb-2 shadow-sm font-bold text-gray-700";
                        btn.onclick = () => showResult(st);
                        btn.innerHTML = `<span>${cleanNm(st.n)}</span>`;
                        container.appendChild(btn);
                    }
                });
            }
        }

        /** [ê²½ë¡œ ì—”ì§„] ë…¼ë¦¬ì  ê±°ì  ë§¤ì¹­ ë° í˜„ì‹¤ì  ì†Œìš” ì‹œê°„ ê³„ì‚° */
        function getPathEngine(st, opt) {
            const n = st.n; const l = st.l.toLowerCase();
            let res = { hub: null, time: 0, msg: "", ride: "ì§€í•˜ì² ", color: "default", hub_line: "" };

            // 1. ì§ì ‘ ì—°ê²°
            if (l === "8") {
                res.time = 15; res.ride = "8í˜¸ì„ "; res.color = "8"; res.msg = `í•‘í¬ìƒ‰ 8í˜¸ì„ ì„ íƒ€ê³  ë°”ë¡œ ê°€ì‹œë©´ ë©ë‹ˆë‹¤.`;
                return res;
            }
            if (l === "gj") {
                res.time = 20; res.ride = "ê²½ì˜ì¤‘ì•™ì„ "; res.color = "gj"; res.msg = `ì˜¥ìƒ‰ ê²½ì˜ì¤‘ì•™ì„ ì„ íƒ€ê³  ë°”ë¡œ ê°€ì‹œë©´ ë©ë‹ˆë‹¤.`;
                return res;
            }

            // 2. ë…¸ì„ ë³„ ê±°ì  ë§¤ì¹­ (0ë¶„ ì˜¤ë¥˜ ë°©ì§€ë¥¼ ìœ„í•œ ì •ë°€ ë¡œì§)
            if (["1", "ap", "ui", "uj", "in1", "in2"].includes(l) || n.includes("ì¸ì²œ") || n.includes("ê³µí•­")) {
                res.hub = "íšŒê¸°"; res.time = (opt==='fast' ? 45 : 55); 
            } else if (l === "2" || l === "shin") {
                if (opt === 'fast') { res.hub = "ì ì‹¤"; res.time = 38; } else { res.hub = "ì™•ì‹­ë¦¬"; res.time = 48; }
            } else if (l === "3") {
                if (opt === 'fast') { res.hub = "ê°€ë½ì‹œì¥"; res.time = 42; } else { res.hub = "ì˜¥ìˆ˜"; res.time = 50; }
            } else if (l === "4") {
                if (["ì§„ì ‘","ì˜¤ë‚¨","ë³„ë‚´ë³„ê°€ëŒ"].includes(n)) { res.hub = "ë³„ë‚´"; res.time = 28; } else { res.hub = "íšŒê¸°"; res.time = 52; }
            } else if (l === "5") {
                res.hub = "ì²œí˜¸"; res.time = 35;
            } else if (l === "7") {
                res.hub = "ìƒë´‰"; res.time = 32;
            } else if (l === "9") {
                res.hub = "ì„ì´Œ"; res.time = 34;
            } else if (l === "suin") {
                if (opt === 'fast') { res.hub = "ë³µì •"; res.time = 44; } else { res.hub = "ì™•ì‹­ë¦¬"; res.time = 56; }
            } else if (l === "gc") {
                res.hub = "ìƒë´‰"; res.time = 22;
            } else if (l === "yi") {
                // ê³ ì§„ì—­ ë“± ì—ë²„ë¼ì¸
                res.hub = "ë³µì •"; res.time = 65; res.msg = "ë³µì •ì—­ì—ì„œ ìˆ˜ì¸ë¶„ë‹¹ì„ ìœ¼ë¡œ ê°ˆì•„íƒ„ ë’¤ ê¸°í¥ì—­ê¹Œì§€ ê°€ì„¸ìš”.";
            } else if (l === "gtx" || l === "gg") {
                res.hub = "ì™•ì‹­ë¦¬"; res.time = 45; res.msg = "ì™•ì‹­ë¦¬ì—ì„œ ìˆ˜ì¸ë¶„ë‹¹ì„ ìœ¼ë¡œ ê°ˆì•„íƒ€ê³  ì´ë§¤(ì„±ë‚¨)ì—­ê¹Œì§€ ê°€ì„¸ìš”.";
            } else {
                res.hub = "ì™•ì‹­ë¦¬"; res.time = 60; // ê¸°ë³¸ê°’
            }

            const hInfo = hubTable[res.hub] || { p: "ì¤‘ê°„", m: "ê°ˆì•„íƒ€ëŠ” ê³³ í‘œì§€íŒì„ ë”°ë¼ê°€ì„¸ìš”.", c: "default", line: "ì§€í•˜ì² " };
            res.ride = hInfo.line; res.color = hInfo.c; res.msg = hInfo.m;
            return res;
        }

        function switchRoute(opt) {
            activeRoute = opt;
            document.getElementById('tab-fast').className = `route-tab flex-1 py-4 font-black text-lg ${opt === 'fast' ? 'active' : ''}`;
            document.getElementById('tab-easy').className = `route-tab flex-1 py-4 font-black text-lg border-l border-gray-100 ${opt === 'easy' ? 'active' : ''}`;
            renderRoute();
        }

        function showResult(st) {
            selStation = st; document.getElementById('target-name-display').innerText = cleanNm(st.n);
            closeSearch(); document.getElementById('main-menu').classList.add('hidden'); document.getElementById('route-detail').classList.remove('hidden');
            switchRoute('fast');
        }

        function renderRoute() {
            if(!selStation) return;
            const fast = getPathEngine(selStation, 'fast');
            const easy = getPathEngine(selStation, 'easy');
            const info = activeRoute === 'fast' ? fast : easy;

            document.getElementById('time-fast').innerText = fast.time + "ë¶„";
            document.getElementById('time-easy').innerText = easy.time + "ë¶„";

            const pathArr = currentMode === 'out' 
                ? ["êµ¬ë¦¬ì—­", info.hub ? cleanNm(info.hub) : null, cleanNm(selStation.n)].filter(Boolean)
                : [cleanNm(selStation.n), info.hub ? cleanNm(info.hub) : null, "êµ¬ë¦¬ì—­"].filter(Boolean);
            
            document.getElementById('route-path-summary').innerHTML = pathArr.map((p, idx) => `<span class="${idx === pathArr.length-1 ? 'text-green-600' : 'text-gray-800'}">${p}</span>${idx < pathArr.length - 1 ? '<span class="text-gray-300 mx-1 font-bold">âœ</span>' : ''}`).join('');

            const content = document.getElementById('route-content');
            if (currentMode === 'in') {
                content.innerHTML = `<div class="p-8 bg-green-50 rounded-[2rem] border-4 border-green-200 text-center mb-4 shadow-sm"><p class="text-2xl font-black text-green-800 mb-2">${cleanNm(selStation.n)} ìŠ¹ì°¨</p><p class="text-xl font-bold text-gray-700 leading-snug">ì•ˆë‚´íŒì—ì„œ <span class="highlight-action">êµ¬ë¦¬ì—­ ë°©í–¥</span>ì„ í™•ì¸í•˜ê³  ì—´ì°¨ë¥¼ íƒ€ê³  ì˜¤ì‹œë©´ ë©ë‹ˆë‹¤.</p></div>`;
            } else {
                let html = `<div class="path-step"><div class="circle-num">1</div><div class="space-y-1"><div class="flex items-center"><span class="line-badge line-8">8í˜¸ì„ </span><span class="line-badge line-gj">ê²½ì˜ì¤‘ì•™</span><span class="text-xl font-black text-gray-800">êµ¬ë¦¬ì—­</span></div><p class="text-xl font-bold text-gray-700 leading-relaxed font-bold">ëª©ì ì§€ ë…¸ì„ ì— ë”°ë¼ ì—´ì°¨ë¥¼ íƒ€ì„¸ìš”.</p></div></div>`;
                if (info.hub) {
                    const tr = hubTable[info.hub] || { p: "ì¤‘ê°„", m: "ë‚´ë ¤ì„œ ê°ˆì•„íƒ€ì„¸ìš”." };
                    html += `<div class="path-step"><div class="circle-num">2</div><div class="space-y-1"><div class="flex items-center"><span class="line-badge line-${info.color}">${info.ride.toUpperCase()}ì„ </span><span class="text-xl font-black text-gray-800">${cleanNm(info.hub)}</span></div><p class="text-xl font-bold text-gray-700 leading-relaxed font-bold"><span class='highlight-action'>ë‚´ë ¤ì„œ</span> ê°ˆì•„íƒ€ì„¸ìš”.</p><p class="text-sm text-gray-500 mt-1">${tr.m}</p><div class="inline-block mt-3 bg-yellow-100 px-4 py-2 rounded-2xl border-2 border-yellow-300 shadow-sm"><p class="text-lg font-black text-yellow-800">ğŸ’¡ ë¹¨ë¦¬ ê°ˆì•„íƒ€ëŠ” ì¹¸: <span class="text-2xl text-red-600 underline font-black">${tr.p}</span></p></div></div></div>`;
                }
                html += `<div class="path-step"><div class="circle-num">${info.hub ? 3 : 2}</div><div class="space-y-1"><div class="flex items-center"><span class="line-badge line-${selStation.l.toLowerCase().replace('ì„ ','')}">${selStation.l.toUpperCase()}ì„ </span><span class="text-xl font-black text-gray-800">${cleanNm(selStation.n)}</span></div><p class="text-xl font-bold text-gray-700 leading-relaxed font-bold">ëª©ì ì§€ì— ë„ì°©í–ˆìŠµë‹ˆë‹¤. <span class="highlight-action">ë‚´ë¦¬ì„¸ìš”</span>.</p></div></div>`;
                content.innerHTML = html;
            }
            updateFav();
        }

        function toggleFavorite() {
            const idx = favoriteList.findIndex(f => f.n === selStation.n);
            if (idx > -1) favoriteList.splice(idx, 1); else favoriteList.push(selStation);
            localStorage.setItem('guri_mama_final_v5_verified', JSON.stringify(favoriteList));
            updateFav();
        }
        function updateFav() { const isFav = favoriteList.some(f => f.n === selStation.n); document.getElementById('fav-btn').innerText = isFav ? 'â­' : 'â˜†'; document.getElementById('fav-btn').style.color = isFav ? '#f59e0b' : '#9ca3af'; }
        function renderFavs() {
            const container = document.getElementById('favorites-list'); const section = document.getElementById('favorites-section');
            if (favoriteList.length === 0) { section.classList.add('hidden'); return; }
            section.classList.remove('hidden'); container.innerHTML = '';
            favoriteList.forEach(fav => {
                const btn = document.createElement('button'); btn.className = "w-full bg-yellow-50 border-2 border-yellow-200 rounded-2xl p-5 flex items-center justify-between shadow-sm active:bg-yellow-100";
                btn.onclick = () => { currentMode = 'out'; showResult(fav); };
                btn.innerHTML = `<span class="text-xl font-black text-gray-800">ğŸ  â†’ ${cleanNm(fav.n)}</span> <span class="text-3xl font-black text-orange-400">âœ</span>`;
                container.appendChild(btn);
            });
        }
        function goHome() { document.getElementById('route-detail').classList.add('hidden'); document.getElementById('main-menu').classList.remove('hidden'); renderFavs(); }
        function toggleMap(show) { document.getElementById('map-modal').classList.toggle('hidden', !show); }
        window.onload = renderFavs;
    </script>
</body>
</html>
